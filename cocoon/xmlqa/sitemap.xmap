<?xml version="1.0"?>
<!-- 
checking pages sitemap. 
SVN: $Id: sitemap.xmap 624 2007-09-05 10:37:39Z zau $
-->
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

  <!-- =========================== Pipelines ================================= -->

  <map:pipelines>
    <map:pipeline>
      <map:match pattern="">
        <!-- Redirect request to the root path to the index page -->
        <map:redirect-to uri="chq/AL_docsite.html"/>
      </map:match>
      <map:match pattern="index.html">
        <!-- Redirect request to the root path to the index page -->
        <map:redirect-to uri="chq/AL_docsite.html"/>
      </map:match>

      <!-- Uses alist_tpkey -->
      <map:match pattern="chq/AL_docsite.html">
        <map:aggregate element="aggregation">
          <map:part src="{global:project-path}{global:project-alist}/AL_docsite.xml" element="docsite"/>
        </map:aggregate>
        <map:transform type="xslt" src="xslt/alist_tpkey.xsl">
          <map:parameter name="context-path" value="{request:contextPath}/xmod"/>
        </map:transform>
        <map:serialize type="xhtml"/>
      </map:match>
      
      <map:match pattern="filelist/AL_fileBase.html">
        <map:aggregate element="aggregation">
          <map:part src="{global:project-path}{global:project-alist}/AL_docsite.xml" element="docsite"/>
          <map:part src="{global:project-path}{global:project-alist}/AL_fileBase.xml" element="source"/>
        </map:aggregate>
        <map:transform type="xslt" src="xslt/alist_tpkey.xsl">
          <map:parameter name="context-path" value="{request:contextPath}/xmod"/>
        </map:transform>
        <map:serialize type="xhtml"/>
      </map:match>
      
      <map:match pattern="filelist/AL_navbar.html">
        <map:aggregate element="aggregation">
          <map:part src="{global:project-path}{global:project-alist}/AL_docsite.xml" element="docsite"/>
          <map:part src="{global:project-path}{global:project-alist}/AL_fileBase.xml" element="filebase"/>
          <map:part src="{global:project-path}{global:project-alist}/AL_navbar.xml" element="source"/>
        </map:aggregate>
        <map:transform type="xslt" src="xslt/navbar_tpkey.xsl">
          <map:parameter name="context-path" value="{request:contextPath}/xmod"/>
        </map:transform>
        <map:serialize type="xhtml"/>
      </map:match>
      
      <!-- Uses image_tpkey -->      
      <map:match pattern="filelist/AL_imageBase.html">
        <map:aggregate element="aggregation">
          <map:part src="{global:project-path}{global:project-alist}/AL_docsite.xml" element="docsite"/>
          <map:part src="{global:project-path}{global:project-alist}/AL_imageBase.xml" element="source"/>
        </map:aggregate>
        <map:transform type="xslt" src="xslt/image_tpkey.xsl">
          <map:parameter name="context-path" value="{request:contextPath}/xmod"/>
        </map:transform>
        <map:serialize type="xhtml"/>
      </map:match>
      
      <map:match pattern="filelist/AL_designImages.html">
        <map:aggregate element="aggregation">
          <map:part src="{global:project-path}{global:project-alist}/AL_docsite.xml" element="docsite"/>
          <map:part src="{global:project-path}{global:project-alist}/AL_designImages.xml" element="source"/>
        </map:aggregate>
        <map:transform type="xslt" src="xslt/image_tpkey.xsl">
          <map:parameter name="context-path" value="{request:contextPath}/xmod"/>
        </map:transform>
        <map:serialize type="xhtml"/>
      </map:match>
      
      <!-- Link checking -->
      <map:match pattern="links/*.html">
        <map:aggregate element="aggregation">
          <map:part src="{global:project-path}{global:project-alist}/AL_docsite.xml" element="docsite"/>
          <map:part src="{global:project-path}{global:project-alist}/AL_fileBase.xml" element="filebase"/>
          <map:part src="cocoon:/link" element="source"/>
        </map:aggregate>
        <map:transform type="xslt" src="xslt/{1}_tpkey.xsl">
          <map:parameter name="context-path" value="{request:contextPath}/xmod"/>
          <map:parameter name="sm-context-id" value="{1}"/>
        </map:transform>
        <map:serialize type="xhtml"/>
      </map:match>
      
      <map:match pattern="link">
        <map:generate type="xpathdirectory" src="{global:project-path}{global:project-materials}">    
          <map:parameter name="depth" value="10"/>
          <map:parameter name="exclude" value=".svn"/>
          <map:parameter name="xpath" value="/TEI.2/@id|/TEI.2/teiHeader//titleStmt|/TEI.2//xref[@type='internal']"/>
          <map:parameter name="xmlFiles" value="\.xml"/>
        </map:generate>
        <map:serialize type="xml"/>
      </map:match>
      
      <!-- Cascading stylesheets -->
      <map:match pattern="css/*.css">
        <map:read src="css/{1}.css"/>
      </map:match>
      <map:match pattern="**/css/*.css">
        <map:read src="css/{2}.css"/>
      </map:match>
    </map:pipeline>
  </map:pipelines>
</map:sitemap>
